local blacklist_entity_hashes = {
    [GetHashKey('lts_prop_lts_ramp_01')] = true,
    [GetHashKey('lts_prop_lts_ramp_02')] = true,
    [GetHashKey('lts_prop_lts_ramp_03')] = true,
    [GetHashKey('prop_byard_ramp')] = true,
    [GetHashKey('prop_byard_rampold')] = true,
    [GetHashKey('prop_byard_rampold_cr')] = true,
    [GetHashKey('prop_gascyl_ramp_01')] = true,
    [GetHashKey('prop_gascyl_ramp_door_01')] = true,
    [GetHashKey('prop_jetski_ramp_01')] = true,
    [GetHashKey('prop_mp_ramp_01')] = true,
    [GetHashKey('prop_mp_ramp_01_tu')] = true,
    [GetHashKey('prop_mp_ramp_02')] = true,
    [GetHashKey('prop_mp_ramp_02_tu')] = true,
    [GetHashKey('prop_mp_ramp_03')] = true,
    [GetHashKey('prop_mp_ramp_03_tu')] = true,
    [GetHashKey('prop_skate_flatramp')] = true,
    [GetHashKey('prop_skate_flatramp_cr')] = true,
    [GetHashKey('prop_water_ramp_01')] = true,
    [GetHashKey('prop_water_ramp_02')] = true,
    [GetHashKey('prop_water_ramp_03')] = true,
    [GetHashKey('v_res_fh_guitaramp')] = true,
    [GetHashKey('stt_prop_ramp_adj_flip_m')] = true,
    [GetHashKey('stt_prop_ramp_adj_flip_mb')] = true,
    [GetHashKey('stt_prop_ramp_adj_flip_s')] = true,
    [GetHashKey('stt_prop_ramp_adj_flip_sb')] = true,
    [GetHashKey('stt_prop_ramp_adj_hloop')] = true,
    [GetHashKey('stt_prop_ramp_adj_loop')] = true,
    [GetHashKey('stt_prop_ramp_jump_l')] = true,
    [GetHashKey('stt_prop_ramp_jump_m')] = true,
    [GetHashKey('stt_prop_ramp_jump_s')] = true,
    [GetHashKey('stt_prop_ramp_jump_xl')] = true,
    [GetHashKey('stt_prop_ramp_jump_xs')] = true,
    [GetHashKey('stt_prop_ramp_jump_xxl')] = true,
    [GetHashKey('stt_prop_ramp_multi_loop_rb')] = true,
    [GetHashKey('stt_prop_ramp_spiral_l')] = true,
    [GetHashKey('stt_prop_ramp_spiral_l_l')] = true,
    [GetHashKey('stt_prop_ramp_spiral_l_m')] = true,
    [GetHashKey('stt_prop_ramp_spiral_l_s')] = true,
    [GetHashKey('stt_prop_ramp_spiral_l_xxl')] = true,
    [GetHashKey('stt_prop_ramp_spiral_m')] = true,
    [GetHashKey('stt_prop_ramp_spiral_s')] = true,
    [GetHashKey('stt_prop_ramp_spiral_xxl')] = true,
    [GetHashKey('stt_prop_stunt_ramp')] = true,
    [GetHashKey('stt_prop_stunt_wideramp')] = true,
    [GetHashKey('stt_prop_stunt_bblock_huge_01')] = true,
    [GetHashKey('stt_prop_stunt_bblock_huge_02')] = true,
    [GetHashKey('stt_prop_stunt_bblock_huge_03')] = true,
    [GetHashKey('stt_prop_stunt_bblock_huge_04')] = true,
    [GetHashKey('stt_prop_stunt_bblock_huge_05')] = true,
    [GetHashKey('stt_prop_stunt_bblock_hump_01')] = true,
    [GetHashKey('stt_prop_stunt_bblock_hump_02')] = true,
    [GetHashKey('stt_prop_stunt_bblock_lrg1')] = true,
    [GetHashKey('stt_prop_stunt_bblock_lrg2')] = true,
    [GetHashKey('stt_prop_stunt_bblock_lrg3')] = true,
    [GetHashKey('stt_prop_stunt_bblock_mdm1')] = true,
    [GetHashKey('stt_prop_stunt_bblock_mdm2')] = true,
    [GetHashKey('stt_prop_stunt_bblock_mdm3')] = true,
    [GetHashKey('stt_prop_stunt_bblock_qp')] = true,
    [GetHashKey('stt_prop_stunt_bblock_qp2')] = true,
    [GetHashKey('stt_prop_stunt_bblock_qp3')] = true,
    [GetHashKey('stt_prop_stunt_bblock_sml1')] = true,
    [GetHashKey('stt_prop_stunt_bblock_sml2')] = true,
    [GetHashKey('stt_prop_stunt_bblock_sml3')] = true,
    [GetHashKey('stt_prop_stunt_bblock_xl1')] = true,
    [GetHashKey('stt_prop_stunt_bblock_xl2')] = true,
    [GetHashKey('stt_prop_stunt_bblock_xl3')] = true,
    [GetHashKey('stt_prop_stunt_bowling_ball')] = true,
    [GetHashKey('stt_prop_stunt_bowling_pin')] = true,
    [GetHashKey('stt_prop_stunt_bowlpin_stand')] = true,
    [GetHashKey('stt_prop_stunt_domino')] = true,
    [GetHashKey('stt_prop_stunt_jump15')] = true,
    [GetHashKey('stt_prop_stunt_jump30')] = true,
    [GetHashKey('stt_prop_stunt_jump45')] = true,
    [GetHashKey('stt_prop_stunt_jump_l')] = true,
    [GetHashKey('stt_prop_stunt_jump_lb')] = true,
    [GetHashKey('stt_prop_stunt_jump_loop')] = true,
    [GetHashKey('stt_prop_stunt_jump_m')] = true,
    [GetHashKey('stt_prop_stunt_jump_mb')] = true,
    [GetHashKey('stt_prop_stunt_jump_s')] = true,
    [GetHashKey('stt_prop_stunt_jump_sb')] = true,
    [GetHashKey('stt_prop_stunt_landing_zone_01')] = true,
    [GetHashKey('stt_prop_stunt_soccer_ball')] = true,
    [GetHashKey('stt_prop_stunt_soccer_goal')] = true,
    [GetHashKey('stt_prop_stunt_soccer_lball')] = true,
    [GetHashKey('stt_prop_stunt_soccer_sball')] = true,
    [GetHashKey('stt_prop_stunt_target')] = true,
    [GetHashKey('stt_prop_stunt_target_small')] = true,
    [GetHashKey('stt_prop_stunt_track_bumps')] = true,
    [GetHashKey('stt_prop_stunt_track_cutout')] = true,
    [GetHashKey('stt_prop_stunt_track_dwlink')] = true,
    [GetHashKey('stt_prop_stunt_track_dwlink_02')] = true,
    [GetHashKey('stt_prop_stunt_track_dwsh15')] = true,
    [GetHashKey('stt_prop_stunt_track_dwshort')] = true,
    [GetHashKey('stt_prop_stunt_track_dwslope15')] = true,
    [GetHashKey('stt_prop_stunt_track_dwslope30')] = true,
    [GetHashKey('stt_prop_stunt_track_dwslope45')] = true,
    [GetHashKey('stt_prop_stunt_track_dwturn')] = true,
    [GetHashKey('stt_prop_stunt_track_dwuturn')] = true,
    [GetHashKey('stt_prop_stunt_track_exshort')] = true,
    [GetHashKey('stt_prop_stunt_track_fork')] = true,
    [GetHashKey('stt_prop_stunt_track_funlng')] = true,
    [GetHashKey('stt_prop_stunt_track_funnel')] = true,
    [GetHashKey('stt_prop_stunt_track_hill')] = true,
    [GetHashKey('stt_prop_stunt_track_hill2')] = true,
    [GetHashKey('stt_prop_stunt_track_jump')] = true,
    [GetHashKey('stt_prop_stunt_track_link')] = true,
    [GetHashKey('stt_prop_stunt_track_otake')] = true,
    [GetHashKey('stt_prop_stunt_track_sh15')] = true,
    [GetHashKey('stt_prop_stunt_track_sh30')] = true,
    [GetHashKey('stt_prop_stunt_track_sh45')] = true,
    [GetHashKey('stt_prop_stunt_track_sh45_a')] = true,
    [GetHashKey('stt_prop_stunt_track_short')] = true,
    [GetHashKey('stt_prop_stunt_track_slope15')] = true,
    [GetHashKey('stt_prop_stunt_track_slope30')] = true,
    [GetHashKey('stt_prop_stunt_track_slope45')] = true,
    [GetHashKey('stt_prop_stunt_track_start')] = true,
    [GetHashKey('stt_prop_stunt_track_start_02')] = true,
    [GetHashKey('stt_prop_stunt_track_straight')] = true,
    [GetHashKey('stt_prop_stunt_track_straightice')] = true,
    [GetHashKey('stt_prop_stunt_track_st_01')] = true,
    [GetHashKey('stt_prop_stunt_track_st_02')] = true,
    [GetHashKey('stt_prop_stunt_track_turn')] = true,
    [GetHashKey('stt_prop_stunt_track_turnice')] = true,
    [GetHashKey('stt_prop_stunt_track_uturn')] = true,
    [GetHashKey('stt_prop_stunt_tube_crn')] = true,
    [GetHashKey('stt_prop_stunt_tube_crn2')] = true,
    [GetHashKey('stt_prop_stunt_tube_crn_15d')] = true,
    [GetHashKey('stt_prop_stunt_tube_crn_30d')] = true,
    [GetHashKey('stt_prop_stunt_tube_crn_5d')] = true,
    [GetHashKey('stt_prop_stunt_tube_cross')] = true,
    [GetHashKey('stt_prop_stunt_tube_end')] = true,
    [GetHashKey('stt_prop_stunt_tube_ent')] = true,
    [GetHashKey('stt_prop_stunt_tube_fn_01')] = true,
    [GetHashKey('stt_prop_stunt_tube_fn_02')] = true,
    [GetHashKey('stt_prop_stunt_tube_fn_03')] = true,
    [GetHashKey('stt_prop_stunt_tube_fn_04')] = true,
    [GetHashKey('stt_prop_stunt_tube_fn_05')] = true,
    [GetHashKey('stt_prop_stunt_tube_fork')] = true,
    [GetHashKey('stt_prop_stunt_tube_gap_01')] = true,
    [GetHashKey('stt_prop_stunt_tube_gap_02')] = true,
    [GetHashKey('stt_prop_stunt_tube_gap_03')] = true,
    [GetHashKey('stt_prop_stunt_tube_hg')] = true,
    [GetHashKey('stt_prop_stunt_tube_jmp')] = true,
    [GetHashKey('stt_prop_stunt_tube_jmp2')] = true,
    [GetHashKey('stt_prop_stunt_tube_l')] = true,
    [GetHashKey('stt_prop_stunt_tube_m')] = true,
    [GetHashKey('stt_prop_stunt_tube_qg')] = true,
    [GetHashKey('stt_prop_stunt_tube_s')] = true,
    [GetHashKey('stt_prop_stunt_tube_speed')] = true,
    [GetHashKey('stt_prop_stunt_tube_speeda')] = true,
    [GetHashKey('stt_prop_stunt_tube_speedb')] = true,
    [GetHashKey('stt_prop_stunt_tube_xs')] = true,
    [GetHashKey('stt_prop_stunt_tube_xxs')] = true,
    [GetHashKey('imp_prop_flatbed_ramp')] = true,
    [GetHashKey('gr_prop_gr_ramproof_gate')] = true,
    [GetHashKey('ar_prop_ar_jetski_ramp.ytd')] = true,
    [GetHashKey('ar_prop_ar_jetski_ramp_01_dev')] = true,
    [GetHashKey('misc_walls25')] = true,
    [GetHashKey('misc_walls24')] = true,
    [GetHashKey('misc_walls23')] = true,
    [GetHashKey('misc_walls22')] = true,
    [GetHashKey('misc_walls21')] = true,
    [GetHashKey('misc_walls20')] = true,
    [GetHashKey('misc_walls19')] = true,
    [GetHashKey('misc_walls18')] = true,
    [GetHashKey('misc_walls17')] = true,
    [GetHashKey('misc_walls16')] = true,
    [GetHashKey('misc_walls15')] = true,
    [GetHashKey('misc_walls14')] = true,
    [GetHashKey('misc_walls13')] = true,
    [GetHashKey('misc_walls12')] = true,
    [GetHashKey('misc_walls11')] = true,
    [GetHashKey('misc_walls10')] = true,
    [GetHashKey('misc_walls9')] = true,
    [GetHashKey('misc_walls8')] = true,
    [GetHashKey('misc_walls6')] = true,
    [GetHashKey('misc_walls5')] = true,
    [GetHashKey('misc_walls4')] = true,
    [GetHashKey('misc_walls3')] = true,
    [GetHashKey('misc_wall3')] = true,
    [GetHashKey('misc_ufo2')] = true,
    [GetHashKey('misc_tower2')] = true,
    [GetHashKey('misc_tower1stair')] = true,
    [GetHashKey('misc_tower1')] = true,
    [GetHashKey('misc_stairs4')] = true,
    [GetHashKey('misc_stairs3')] = true,
    [GetHashKey('misc_stairs2')] = true,
    [GetHashKey('misc_ship1')] = true,
    [GetHashKey('misc_scult2')] = true,
    [GetHashKey('misc_scult1')] = true,
    [GetHashKey('misc_sb_grass1b')] = true,
    [GetHashKey('misc_sb_grass1a')] = true,
    [GetHashKey('misc_satelite')] = true,
    [GetHashKey('misc_roofs5')] = true,
    [GetHashKey('misc_roofs4')] = true,
    [GetHashKey('misc_roofs3')] = true,
    [GetHashKey('misc_roofs2')] = true,
    [GetHashKey('misc_roofs1')] = true,
    [GetHashKey('misc_razorl')] = true,
    [GetHashKey('misc_plant_weed1')] = true,
    [GetHashKey('misc_plant_flower1')] = true,
    [GetHashKey('misc_plant_bana2')] = true,
    [GetHashKey('misc_plant_bana1')] = true,
    [GetHashKey('misc_pagoda')] = true,
    [GetHashKey('misc_logwall3a')] = true,
    [GetHashKey('misc_logwall3')] = true,
    [GetHashKey('misc_logwall2a')] = true,
    [GetHashKey('misc_logwall2')] = true,
    [GetHashKey('misc_logwall')] = true,
    [GetHashKey('misc_lighth2')] = true,
    [GetHashKey('misc_jetty1')] = true,
    [GetHashKey('misc_hatch')] = true,
    [GetHashKey('misc_dino')] = true,
    [GetHashKey('misc_dam')] = true,
    [GetHashKey('misc_carpark1')] = true,
    [GetHashKey('land_sandbar')] = true,
    [GetHashKey('land_sand1')] = true,
    [GetHashKey('land_rock7d')] = true,
    [GetHashKey('land_rock7c')] = true,
    [GetHashKey('land_rock7b')] = true,
    [GetHashKey('land_rock7a')] = true,
    [GetHashKey('land_rock7')] = true,
    [GetHashKey('land_rock6a')] = true,
    [GetHashKey('land_rock6')] = true,
    [GetHashKey('land_rock5e')] = true,
    [GetHashKey('land_rock5d')] = true,
    [GetHashKey('land_rock5b')] = true,
    [GetHashKey('land_rock5a')] = true,
    [GetHashKey('land_rock5')] = true,
    [GetHashKey('land_rock4a')] = true,
    [GetHashKey('land_rock4')] = true,
    [GetHashKey('land_rock3')] = true,
    [GetHashKey('land_rock2')] = true,
    [GetHashKey('land_rock1g')] = true,
    [GetHashKey('land_rock1f')] = true,
    [GetHashKey('land_rock1e')] = true,
    [GetHashKey('land_rock1d')] = true,
    [GetHashKey('land_rock1c')] = true,
    [GetHashKey('land_rock1b')] = true,
    [GetHashKey('land_rock1')] = true,
    [GetHashKey('land_mnt1c')] = true,
    [GetHashKey('land_island1')] = true,
    [GetHashKey('land_hrock1cut')] = true,
    [GetHashKey('land_hrock1')] = true,
    [GetHashKey('land_hill3')] = true,
    [GetHashKey('land_hill2')] = true,
    [GetHashKey('land_hill1')] = true,
    [GetHashKey('land_grass1')] = true,
    [GetHashKey('land_fur1')] = true,
    [GetHashKey('land_des1')] = true,
    [GetHashKey('land_crop3bis')] = true,
    [GetHashKey('land_crop3')] = true,
    [GetHashKey('land_crop2')] = true,
    [GetHashKey('land_crop1')] = true,
    [GetHashKey('land_conc5')] = true,
    [GetHashKey('land_conc4')] = true,
    [GetHashKey('land_conc3')] = true,
    [GetHashKey('land_conc2')] = true,
    [GetHashKey('land_conc1')] = true,
    [GetHashKey('Land_cave')] = true,
    [GetHashKey('land_carpark2')] = true,
    [GetHashKey('land_beach2')] = true,
    [GetHashKey('land_beach1')] = true,
    [GetHashKey('land_arch1a')] = true,
    [GetHashKey('land_arch1')] = true,
    [GetHashKey('des_tankerexplosion_01')] = true,
    [GetHashKey('des_tankerexplosion_02')] = true,
    [GetHashKey('hei_prop_carrier_bombs_1')] = true,
    [GetHashKey('prop_bomb_01')] = true,
    [GetHashKey('prop_bomb_01_s')] = true,
    [GetHashKey('prop_food_bs_burg1')] = true,
    [GetHashKey('prop_food_bs_burg3')] = true,
    [GetHashKey('prop_food_bs_burger2')] = true,
    [GetHashKey('prop_food_burg3')] = true
}


local minipunchDiscordID = "<@178016707292561409>"
local WEBHOOK_URL = "https://discordapp.com/api/webhooks/618094411003199509/IeXSWsln5hPo83l5wles9m62kEAKAJQUry6cZvV0MQzCLa6mYgBZOEVdtwwjpC1MUwoh"

AddEventHandler('scrambler:injectionDetected', function(name, source, isServerEvent)
    local eventType = 'client'
    if isServerEvent then
        eventType = 'server'
    end
    local msg = 'Player id [' .. source .. ' / ' .. (GetPlayerIdentifiers(source)[1] or 'N/A') .. '] attempted to use ' .. eventType .. ' event [' .. name .. ']'
    exports.globals:SendDiscordLog(WEBHOOK_URL, msg .. " " .. minipunchDiscordID)
    exports["es_admin"]:BanPlayer(source, "Modding (code injection). If you feel this was a mistake please let a staff member know.")
end)

local eventNameVariableToSkipBeingScrambled = "entityCreated"
AddEventHandler(eventNameVariableToSkipBeingScrambled,  function(entity)
  if DoesEntityExist(entity) then
    if blacklist_entity_hashes[GetEntityModel(entity)] then
      local player = NetworkGetEntityOwner(entity)
      local user = exports["essentialmode"]:getPlayerFromId(player)
      local userGroup = user.getGroup()
      if userGroup == 'user' then
          exports["es_admin"]:BanPlayer(player, "Modding (object spawning). If you feel this was a mistake please let a staff member know.")
      end
    end
  end
end)
