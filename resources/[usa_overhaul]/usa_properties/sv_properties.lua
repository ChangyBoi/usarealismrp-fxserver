local properties = {
	['Perrera Beach Motel'] = {
		location = 'Bay City Avenue, Los Santos',
		interior = 'motel',
		type = 'motel',
		weightLimit = 100,
		cashLimit = 5000,
		office = {-1477.11, -674.48, 29.04},
		rooms = {
			{name = 'Room 1', coords = {-1493.75, -668.33, 29.02}, heading = 317.0, voiceChannel = 501, owner = false, instance = {}, locked = true},
			{name = 'Room 2', coords = {-1498.18, -664.69, 29.02}, heading = 317.0, voiceChannel = 502, owner = false, instance = {}, locked = true},
			{name = 'Room 3', coords = {-1495.33, -661.57, 29.02}, heading = 213.0, voiceChannel = 503, owner = false, instance = {}, locked = true},
			{name = 'Room 4', coords = {-1490.72, -658.23, 29.02}, heading = 213.0, voiceChannel = 504, owner = false, instance = {}, locked = true},
			{name = 'Room 5', coords = {-1486.77, -655.44, 29.58}, heading = 213.0, voiceChannel = 505, owner = false, instance = {}, locked = true},
			{name = 'Room 6', coords = {-1482.22, -652.07, 29.58}, heading = 213.0, voiceChannel = 506, owner = false, instance = {}, locked = true},
			{name = 'Room 7', coords = {-1478.19, -649.10, 29.58}, heading = 213.0, voiceChannel = 507, owner = false, instance = {}, locked = true},
			{name = 'Room 8', coords = {-1473.60, -645.81, 29.58}, heading = 213.0, voiceChannel = 508, owner = false, instance = {}, locked = true},
			{name = 'Room 9', coords = {-1469.73, -642.97, 29.58}, heading = 213.0, voiceChannel = 509, owner = false, instance = {}, locked = true},
			{name = 'Room 10', coords = {-1465.07, -639.59, 29.58}, heading = 213.0, voiceChannel = 510, owner = false, instance = {}, locked = true},
			{name = 'Room 11', coords = {-1461.23, -640.87, 29.58}, heading = 124.0, voiceChannel = 511, owner = false, instance = {}, locked = true},
			{name = 'Room 12', coords = {-1452.40, -653.21, 29.58}, heading = 124.0, voiceChannel = 512, owner = false, instance = {}, locked = true},
			{name = 'Room 13', coords = {-1454.44, -655.91, 29.58}, heading = 34.0, voiceChannel = 513, owner = false, instance = {}, locked = true},
			{name = 'Room 14', coords = {-1458.95, -659.32, 29.58}, heading = 34.0, voiceChannel = 514, owner = false, instance = {}, locked = true},
			{name = 'Room 15', coords = {-1462.92, -662.17, 29.58}, heading = 34.0, voiceChannel = 515, owner = false, instance = {}, locked = true},
			{name = 'Room 16', coords = {-1467.47, -665.49, 29.58}, heading = 34.0, voiceChannel = 516, owner = false, instance = {}, locked = true},
			{name = 'Room 17', coords = {-1471.44, -668.38, 29.58}, heading = 34.0, voiceChannel = 517, owner = false, instance = {}, locked = true},
			{name = 'Room 18', coords = {-1461.31, -640.84, 33.38}, heading = 130.0, voiceChannel = 518, owner = false, instance = {}, locked = true},
			{name = 'Room 19', coords = {-1457.87, -645.48, 33.38}, heading = 130.0, voiceChannel = 519, owner = false, instance = {}, locked = true},
			{name = 'Room 20', coords = {-1455.66, -648.52, 33.38}, heading = 130.0, voiceChannel = 520, owner = false, instance = {}, locked = true},
			{name = 'Room 21', coords = {-1452.40, -653.20, 33.38}, heading = 130.0, voiceChannel = 521, owner = false, instance = {}, locked = true},
			{name = 'Room 22', coords = {-1454.36, -655.97, 33.38}, heading = 34.0, voiceChannel = 522, owner = false, instance = {}, locked = true},
			{name = 'Room 23', coords = {-1458.90, -659.26, 33.38}, heading = 34.0, voiceChannel = 523, owner = false, instance = {}, locked = true},
			{name = 'Room 24', coords = {-1462.92, -662.20, 33.38}, heading = 34.0, voiceChannel = 524, owner = false, instance = {}, locked = true},
			{name = 'Room 25', coords = {-1467.55, -665.52, 33.38}, heading = 34.0, voiceChannel = 525, owner = false, instance = {}, locked = true},
			{name = 'Room 26', coords = {-1471.48, -668.40, 33.38}, heading = 34.0, voiceChannel = 526, owner = false, instance = {}, locked = true},
			{name = 'Room 27', coords = {-1476.09, -671.77, 33.38}, heading = 34.0, voiceChannel = 527, owner = false, instance = {}, locked = true},
			{name = 'Room 28', coords = {-1465.08, -639.60, 33.38}, heading = 213.0, voiceChannel = 528, owner = false, instance = {}, locked = true},
			{name = 'Room 29', coords = {-1469.66, -642.91, 33.38}, heading = 213.0, voiceChannel = 529, owner = false, instance = {}, locked = true},
			{name = 'Room 30', coords = {-1473.55, -645.79, 33.38}, heading = 213.0, voiceChannel = 530, owner = false, instance = {}, locked = true},
			{name = 'Room 31', coords = {-1478.26, -649.15, 33.38}, heading = 213.0, voiceChannel = 531, owner = false, instance = {}, locked = true},
			{name = 'Room 32', coords = {-1482.22, -652.06, 33.38}, heading = 213.0, voiceChannel = 532, owner = false, instance = {}, locked = true}
		}
	},
	['The Motor Hotel'] = {
		location = 'Route 68, Blaine County',
		interior = 'motel',
		type = 'motel',
		weightLimit = 100,
		cashLimit = 5000,
		office = {1142.32, 2663.89, 38.16},
		rooms = {
			{name = 'Room 1', coords = {1142.40, 2654.65, 38.15}, heading = 93.0, voiceChannel = 601, owner = false, instance = {}, locked = true},
			{name = 'Room 2', coords = {1142.38, 2651.04, 38.14}, heading = 93.0, voiceChannel = 602, owner = false, instance = {}, locked = true},
			{name = 'Room 3', coords = {1142.34, 2643.60, 38.14}, heading = 93.0, voiceChannel = 603, owner = false, instance = {}, locked = true},
			{name = 'Room 4', coords = {1141.15, 2641.64, 38.14}, heading = 93.0, voiceChannel = 604, owner = false, instance = {}, locked = true},
			{name = 'Room 5', coords = {1136.34, 2641.68, 38.14}, heading = 1.0, voiceChannel = 605, owner = false, instance = {}, locked = true},
			{name = 'Room 6', coords = {1132.73, 2641.65, 38.14}, heading = 1.0, voiceChannel = 606, owner = false, instance = {}, locked = true},
			{name = 'Room 7', coords = {1125.22, 2641.66, 38.14}, heading = 1.0, voiceChannel = 607, owner = false, instance = {}, locked = true},
			{name = 'Room 8', coords = {1121.45, 2641.64, 38.14}, heading = 1.0, voiceChannel = 608, owner = false, instance = {}, locked = true},
			{name = 'Room 9', coords = {1114.75, 2641.64, 38.14}, heading = 1.0, voiceChannel = 609, owner = false, instance = {}, locked = true},
			{name = 'Room 10', coords = {1107.21, 2641.68, 38.14}, heading = 1.0, voiceChannel = 610, owner = false, instance = {}, locked = true},
			{name = 'Room 11', coords = {1106.01, 2649.09, 38.14}, heading = 267.0, voiceChannel = 611, owner = false, instance = {}, locked = true},
			{name = 'Room 12', coords = {1106.02, 2652.88, 38.14}, heading = 267.0, voiceChannel = 612, owner = false, instance = {}, locked = true}
		}
	},
	['Eastern Motel'] = {
		location = 'Harmony, Blaine County',
		interior = 'motel',
		type = 'motel',
		weightLimit = 100,
		cashLimit = 5000,
		office = {316.98, 2622.9, 44.45},
		rooms = {
			{name = 'Room 1', coords = {341.70, 2614.93, 44.67}, heading = 31.0, voiceChannel = 701, owner = false, instance = {}, locked = true},
			{name = 'Room 2', coords = {347.02, 2618.11, 44.67}, heading = 31.0, voiceChannel = 702, owner = false, instance = {}, locked = true},
			{name = 'Room 3', coords = {354.42, 2619.79, 44.67}, heading = 31.0, voiceChannel = 703, owner = false, instance = {}, locked = true},
			{name = 'Room 4', coords = {359.80, 2622.86, 44.67}, heading = 31.0, voiceChannel = 704, owner = false, instance = {}, locked = true},
			{name = 'Room 5', coords = {367.12, 2624.55, 44.67}, heading = 31.0, voiceChannel = 705, owner = false, instance = {}, locked = true},
			{name = 'Room 6', coords = {372.48, 2627.60, 44.67}, heading = 31.0, voiceChannel = 706, owner = false, instance = {}, locked = true},
			{name = 'Room 7', coords = {379.91, 2629.26, 44.67}, heading = 31.0, voiceChannel = 707, owner = false, instance = {}, locked = true},
			{name = 'Room 8', coords = {385.31, 2632.37, 44.67}, heading = 31.0, voiceChannel = 708, owner = false, instance = {}, locked = true},
			{name = 'Room 9', coords = {392.59, 2634.10, 44.67}, heading = 31.0, voiceChannel = 709, owner = false, instance = {}, locked = true},
			{name = 'Room 10', coords = {397.98, 2637.14, 44.67}, heading = 31.0, voiceChannel = 710, owner = false, instance = {}, locked = true}
		}
	},
	['Burton Apartments'] = { 
		location = 'Occupation Avenue, Los Santos',
		interior = 'lowapartment',
		type = 'apartment',
		payment = 1500,
		weightLimit = 250,
		cashLimit = 10000,
		office = {-83.31, -282.18, 45.5},
		rooms = {
			{name = 'Apartment 1', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 801, owner = false, instance = {}, locked = true},
			{name = 'Apartment 2', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 802, owner = false, instance = {}, locked = true},
			{name = 'Apartment 3', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 803, owner = false, instance = {}, locked = true},
			{name = 'Apartment 4', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 804, owner = false, instance = {}, locked = true},
			{name = 'Apartment 5', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 805, owner = false, instance = {}, locked = true},
			{name = 'Apartment 6', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 806, owner = false, instance = {}, locked = true},
			{name = 'Apartment 7', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 807, owner = false, instance = {}, locked = true},
			{name = 'Apartment 8', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 808, owner = false, instance = {}, locked = true},
			{name = 'Apartment 9', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 809, owner = false, instance = {}, locked = true},
			{name = 'Apartment 10', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 810, owner = false, instance = {}, locked = true},
			{name = 'Apartment 11', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 811, owner = false, instance = {}, locked = true},
			{name = 'Apartment 12', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 812, owner = false, instance = {}, locked = true},
			{name = 'Apartment 13', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 813, owner = false, instance = {}, locked = true},
			{name = 'Apartment 14', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 814, owner = false, instance = {}, locked = true},
			{name = 'Apartment 15', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 815, owner = false, instance = {}, locked = true},
			{name = 'Apartment 16', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 816, owner = false, instance = {}, locked = true},
			{name = 'Apartment 17', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 817, owner = false, instance = {}, locked = true},
			{name = 'Apartment 18', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 818, owner = false, instance = {}, locked = true},
			{name = 'Apartment 19', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 819, owner = false, instance = {}, locked = true},
			{name = 'Apartment 20', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 820, owner = false, instance = {}, locked = true},
			{name = 'Apartment 21', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 821, owner = false, instance = {}, locked = true},
			{name = 'Apartment 22', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 822, owner = false, instance = {}, locked = true},
			{name = 'Apartment 23', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 823, owner = false, instance = {}, locked = true},
			{name = 'Apartment 24', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 824, owner = false, instance = {}, locked = true},
			{name = 'Apartment 25', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 825, owner = false, instance = {}, locked = true},
			{name = 'Apartment 26', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 826, owner = false, instance = {}, locked = true},
			{name = 'Apartment 27', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 827, owner = false, instance = {}, locked = true},
			{name = 'Apartment 28', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 828, owner = false, instance = {}, locked = true},
			{name = 'Apartment 29', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 829, owner = false, instance = {}, locked = true},
			{name = 'Apartment 30', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 830, owner = false, instance = {}, locked = true},
			{name = 'Apartment 31', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 831, owner = false, instance = {}, locked = true},
			{name = 'Apartment 32', coords = {-85.95, -281.97, 45.55}, heading = 350.0, voiceChannel = 832, owner = false, instance = {}, locked = true}
		}
	},
	['Tinsel Towers'] = {
		location = 'Boulevard Del Perro, Los Santos',
		interior = 'midapartment',
		type = 'apartment',
		payment = 3000,
		weightLimit = 500,
		cashLimit = 20000,
		office = {-621.49, 37.19, 43.58},
		rooms = {
			{name = 'Apartment 1', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 901, owner = false, instance = {}, locked = true},
			{name = 'Apartment 2', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 902, owner = false, instance = {}, locked = true},
			{name = 'Apartment 3', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 903, owner = false, instance = {}, locked = true},
			{name = 'Apartment 4', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 904, owner = false, instance = {}, locked = true},
			{name = 'Apartment 5', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 905, owner = false, instance = {}, locked = true},
			{name = 'Apartment 6', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 906, owner = false, instance = {}, locked = true},
			{name = 'Apartment 7', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 907, owner = false, instance = {}, locked = true},
			{name = 'Apartment 8', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 908, owner = false, instance = {}, locked = true},
			{name = 'Apartment 9', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 909, owner = false, instance = {}, locked = true},
			{name = 'Apartment 10', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 910, owner = false, instance = {}, locked = true},
			{name = 'Apartment 11', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 911, owner = false, instance = {}, locked = true},
			{name = 'Apartment 12', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 912, owner = false, instance = {}, locked = true},
			{name = 'Apartment 13', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 913, owner = false, instance = {}, locked = true},
			{name = 'Apartment 14', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 914, owner = false, instance = {}, locked = true},
			{name = 'Apartment 15', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 915, owner = false, instance = {}, locked = true},
			{name = 'Apartment 16', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 916, owner = false, instance = {}, locked = true},
			{name = 'Apartment 17', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 917, owner = false, instance = {}, locked = true},
			{name = 'Apartment 18', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 918, owner = false, instance = {}, locked = true},
			{name = 'Apartment 19', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 919, owner = false, instance = {}, locked = true},
			{name = 'Apartment 20', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 920, owner = false, instance = {}, locked = true},
			{name = 'Apartment 21', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 921, owner = false, instance = {}, locked = true},
			{name = 'Apartment 22', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 922, owner = false, instance = {}, locked = true},
			{name = 'Apartment 23', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 923, owner = false, instance = {}, locked = true},
			{name = 'Apartment 24', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 924, owner = false, instance = {}, locked = true},
			{name = 'Apartment 25', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 925, owner = false, instance = {}, locked = true},
			{name = 'Apartment 26', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 926, owner = false, instance = {}, locked = true},
			{name = 'Apartment 27', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 927, owner = false, instance = {}, locked = true},
			{name = 'Apartment 28', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 928, owner = false, instance = {}, locked = true},
			{name = 'Apartment 29', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 929, owner = false, instance = {}, locked = true},
			{name = 'Apartment 30', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 930, owner = false, instance = {}, locked = true},
			{name = 'Apartment 31', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 931, owner = false, instance = {}, locked = true},
			{name = 'Apartment 32', coords = {-617.00, 37.94, 43.59}, heading = 170.0, voiceChannel = 932, owner = false, instance = {}, locked = true}
		}	
	},
	['Eclipse Towers'] = {
		location = 'South Mo Milton Drive, Los Santos',
		interior = 'highapartment',
		type = 'apartment',
		payment = 7500,
		weightLimit = 1000,
		cashLimit = 50000,
		office = {-778.88, 313.14, 85.69},
		rooms = {
			{name = 'Apartment 1', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1001, owner = false, instance = {}, locked = true},
			{name = 'Apartment 2', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1002, owner = false, instance = {}, locked = true},
			{name = 'Apartment 3', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1003, owner = false, instance = {}, locked = true},
			{name = 'Apartment 4', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1004, owner = false, instance = {}, locked = true},
			{name = 'Apartment 5', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1005, owner = false, instance = {}, locked = true},
			{name = 'Apartment 6', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1006, owner = false, instance = {}, locked = true},
			{name = 'Apartment 7', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1007, owner = false, instance = {}, locked = true},
			{name = 'Apartment 8', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1008, owner = false, instance = {}, locked = true},
			{name = 'Apartment 9', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1009, owner = false, instance = {}, locked = true},
			{name = 'Apartment 10', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1010, owner = false, instance = {}, locked = true},
			{name = 'Apartment 11', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1011, owner = false, instance = {}, locked = true},
			{name = 'Apartment 12', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1012, owner = false, instance = {}, locked = true},
			{name = 'Apartment 13', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1013, owner = false, instance = {}, locked = true},
			{name = 'Apartment 14', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1014, owner = false, instance = {}, locked = true},
			{name = 'Apartment 15', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1015, owner = false, instance = {}, locked = true},
			{name = 'Apartment 16', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1016, owner = false, instance = {}, locked = true},
			{name = 'Apartment 17', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1017, owner = false, instance = {}, locked = true},
			{name = 'Apartment 18', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1018, owner = false, instance = {}, locked = true},
			{name = 'Apartment 19', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1019, owner = false, instance = {}, locked = true},
			{name = 'Apartment 20', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1020, owner = false, instance = {}, locked = true},
			{name = 'Apartment 21', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1021, owner = false, instance = {}, locked = true},
			{name = 'Apartment 22', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1022, owner = false, instance = {}, locked = true},
			{name = 'Apartment 23', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1023, owner = false, instance = {}, locked = true},
			{name = 'Apartment 24', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1024, owner = false, instance = {}, locked = true},
			{name = 'Apartment 25', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1025, owner = false, instance = {}, locked = true},
			{name = 'Apartment 26', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1026, owner = false, instance = {}, locked = true},
			{name = 'Apartment 27', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1027, owner = false, instance = {}, locked = true},
			{name = 'Apartment 28', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1028, owner = false, instance = {}, locked = true},
			{name = 'Apartment 29', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1029, owner = false, instance = {}, locked = true},
			{name = 'Apartment 30', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1030, owner = false, instance = {}, locked = true},
			{name = 'Apartment 31', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1031, owner = false, instance = {}, locked = true},
			{name = 'Apartment 32', coords = {-775.05, 313.14, 85.69}, heading = 170.0, voiceChannel = 1032, owner = false, instance = {}, locked = true}
		}
	},
	['Houses'] = {
		interior = 'midapartment',
		type = 'house',
		weightLimit = 2000,
		cashLimit = 65000,
		rooms = {

		}
	}
}

local interiors = {
	['motel'] = {
		coords = {151.39, -1007.74, -99.0},
		heading = 359.0,
		storage = {151.24, -1003.05, -99.0},
		wardrobe = {151.70, -1001.40, -99.0},
		bathroom = {154.18, -1000.57, -99.0}
	},
	['lowapartment'] = {
		coords = {266.14, -1007.61, -101.00},
		heading = 0.0,
		storage = {265.95, -999.49, -99.0},
		wardrobe = {259.95, -1004.11, -99.0},
		bathroom = {255.60, -1000.47, -99.0}
	},
	['midapartment'] = {
		coords = {346.47, -1013.05, -99.19},
		heading = 356.0,
		storage = {351.19, -999.16, -99.19},
		wardrobe = {350.67, -993.60, -99.19},
		bathroom = {347.23, -994.11, -99.19}
	},
	['highapartment'] = {
		coords = {-781.77, 322.00, 211.99},
		heading = 355.0,
		storage = {-790.74, 330.53, 210.79},
		wardrobe = {-793.43, 326.53, 210.79},
		bathroom = {-798.81, 330.15, 210.79}
	}
}

local buzzedApartments = {}

RegisterServerEvent('properties:saveOutfit')
AddEventHandler('properties:saveOutfit', function(outfit, slot)
	local user = exports["essentialmode"]:getPlayerFromId(source)
	local outfits = user.getActiveCharacterData('outfits')
	if not outfits then outfits = {} outfits[slot] = {} else if not outfits[slot] then outfits[slot] = {} end end
	outfits[slot] = outfit
	user.setActiveCharacterData('outfits', outfits)
	TriggerClientEvent('usa:notify', source, 'Outfit has been saved!')
end)

RegisterServerEvent('properties:loadOutfit')
AddEventHandler('properties:loadOutfit', function(slot)
	local user = exports["essentialmode"]:getPlayerFromId(source)
	local outfits = user.getActiveCharacterData('outfits')
	TriggerClientEvent('properties:loadOutfit', source, outfits[slot])
end)

TriggerEvent('es:addJobCommand', 'breach', {'sheriff', 'police'}, function(source, args, user)
	TriggerClientEvent('properties:findRoomToBreach', source, args[2])
end, {
	help = "Breach into the nearest property",
	params = {
		{ name = "apt", help = "apartment number (omit if motel)" }
	}
})

TriggerEvent('es:addJobCommand', 'createhouse', {'judge'}, function(source, args, user, location)
	local targetSource = tonumber(args[2])
	if targetSource and GetPlayerName(targetSource) then
		local target = exports["essentialmode"]:getPlayerFromId(targetSource)
		local property = target.getActiveCharacterData('property')
		if property['house'] then
			TriggerClientEvent('usa:notify', source, 'This person already owns a house!')
		else
			TriggerClientEvent('properties:getHeadingForHouse', source, targetSource, location)
		end
	end
end, {
	help = "Create a house for a player where you're standing.",
	params = {
		{ name = "id", help = "player id" }
	}
})

TriggerEvent('es:addJobCommand', 'setgarage', {'judge'}, function(source, args, user, location)
	local targetSource = tonumber(args[2])
	if targetSource and GetPlayerName(targetSource) then
		local target = exports["essentialmode"]:getPlayerFromId(targetSource)
		local property = target.getActiveCharacterData('property')
		if property['house'] then
			property['garageCoords'] = location
			for i = 1, #properties['Houses'].rooms do
				local room = properties['Houses'].rooms[i]
				if room.owner == targetSource then
					room.garage = property['garageCoords']
					TriggerClientEvent('properties:updateData', -1, 'Houses', i, properties['Houses'].rooms[i])
					target.setActiveCharacterData('property', property)
					return
				end
			end
		else
			TriggerClientEvent('usa:notify', source, 'This person doesn\'t own a house!')
		end
	end
end, {
	help = "Set a garage for a player's house where you're standing.",
	params = {
		{ name = "id", help = "player id" }
	}
})

RegisterServerEvent('properties:continueHousePurchase')
AddEventHandler('properties:continueHousePurchase', function(targetSource, location, heading)
	local user = exports["essentialmode"]:getPlayerFromId(source)
	if user.getActiveCharacterData('job') == 'judge' then
		local target = exports["essentialmode"]:getPlayerFromId(targetSource)
		local property = target.getActiveCharacterData('property')
		property['location'] = 'Houses'
		property['house'] = math.random(1000000, 9999999)
		property['houseCoords'] = location
		property['houseHeading'] = heading
		_data = {
			name = 'House',
			coords = property['houseCoords'],
			garage = property['garageCoords'],
			heading = property['houseHeading'],
			owner = targetSource,
			voiceChannel = property['house'],
			instance = {},
			locked = true
		}
		table.insert(properties['Houses'].rooms, _data)
		target.setActiveCharacterData('property', property)
		TriggerClientEvent('usa:notify', source, 'House has been created for ~y~'..target.getActiveCharacterData('fullName')..'~s~. ~y~(~s~'..property['house']..'~y~)~s~')
		TriggerClientEvent('usa:notify', targetSource, 'You now have ownership over a house, ordered by ~y~'..user.getActiveCharacterData('fullName')..'~s~. ~y~(~s~'..property['house']..'~y~)~s~')
		RefreshProperties(targetSource, false)
	end
end)

TriggerEvent('es:addJobCommand', 'deletehouse', {'judge'}, function(source, args, user, location)
	local targetSource = tonumber(args[2])
	if targetSource and GetPlayerName(targetSource) then
		local target = exports["essentialmode"]:getPlayerFromId(targetSource)
		local property = target.getActiveCharacterData('property')
		if property['house'] then
			property['house'] = false
			property['houseCoords'] = nil
			property['garageCoords'] = nil
			property['houseHeading'] = nil
			property['location'] = 'Perrera Beach Motel'
			target.setActiveCharacterData('property', property)
			TriggerClientEvent('usa:notify', targetSource, 'Your house is now foreclosure, ordered by ~y~'..user.getActiveCharacterData('fullName')..'~s~!')
			TriggerClientEvent('usa:notify', source, 'House of ~y~'..target.getActiveCharacterData('fullName')..'~s~ is now foreclosure.')
			RefreshProperties(targetSource, false)
		end
	end
end, {
	help = "Delete a house for a player.",
	params = {
		{ name = "id", help = "player id" }
	}
})

function canPropertyHoldItem(owner, location, itemToCheck)
	local maxWeight = properties[location].weightLimit
	local totalWeight = 0.0
	local user = exports["essentialmode"]:getPlayerFromId(owner)
	local property = user.getActiveCharacterData('property')
	for i = 1, #property['storage'] do
		local item = property['storage'][i]
		if item then
			if not item.weight and item.type == 'weapon' then item.weight = 5 else item.weight = 1 end
			totalWeight = totalWeight + (item.weight * item.quantity)
		end
	end
	if not itemToCheck.quantity then itemToCheck.quantity = 1 end
	if not itemToCheck.weight then itemToCheck.weight = 1.0 end
	if totalWeight + (itemToCheck.weight * itemToCheck.quantity) <= maxWeight then
		return true
	else
		return false
	end
end

function RefreshProperties(source, spawnAtProperty)
	for property, data in pairs(properties) do
		if data.type == 'house' then
			for i = #data.rooms, 1, -1 do
				local room = properties[property].rooms[i]
				if room.owner == source then
					table.remove(properties[property].rooms, i)
					TriggerClientEvent('properties:removeData', source, property, i)
				end
			end
		end
		for i = 1, #data.rooms do
			local room = properties[property].rooms[i]
			if room.owner == source then
				properties[property].rooms[i].owner = false
				TriggerClientEvent('properties:updateData', -1, property, i, properties[property].rooms[i])
			end
		end
	end

	-- create property for character -- 
	local user = exports["essentialmode"]:getPlayerFromId(source)
	if not user then return end
	local property = user.getActiveCharacterData('property')

	if not property then
		property = {
			['location'] = 'Perrera Beach Motel',
			['storage'] = {},
			['money'] = 0,
			['house'] = false
		}
		user.setActiveCharacterData('property', property)
	end

	if not property['house'] then
		-- evict owner if time has exceeded
		if properties[property['location']].type == 'apartment' then
			local paid_time = property['paid_time']
			if paid_time == nil then
				paid_time = os.time()
				property['paid_time'] = os.time()
				user.setActiveCharacterData('property', property)
				print('paid_time not found, data has been updated')
			end
			if GetWholeDaysFromTime(paid_time) >= 7 then
				local bank = user.getActiveCharacterData('bank')
				if bank - properties[property['location']].payment >= 0 then
					user.setActiveCharacterData('bank', bank - properties[property['location']].payment)
					property['paid_time'] = os.time()
					TriggerClientEvent('usa:notify', source, 'You have paid ~y~$'..properties[property['location']].payment..'~s~ for your apartment!')
					user.setActiveCharacterData('property', property)
				else
					property['location'] = 'Perrera Beach Motel'
					property['paid_time'] = os.time
					TriggerClientEvent('usa:notify', source, 'You have been evicted from your apartment, find your room at ~y~Perrera Beach Motel~s~!')
					user.setActiveCharacterData('property', property)
				end
			end
		end

		for _property, data in pairs(properties) do
			if _property == property['location'] then
				for i = 1, #data.rooms do
					local room = properties[_property].rooms[i]
					if not room.owner then
						properties[_property].rooms[i].owner = source
						TriggerClientEvent('properties:updateData', -1, _property, i, properties[_property].rooms[i])
						TriggerClientEvent('properties:updateBlip', source, _property, i)
						TriggerClientEvent('usa:notify', source, 'Your property is at ~y~'.._property..'~s~, room '..i..'.')
						if spawnAtProperty then
							TriggerEvent('properties:requestEntry', _property, i, source)
						end
						return
					end
				end
			end
		end
		for _property, data in pairs(properties) do
			if properties[property['location']].type == 'motel' then
				for i = 1, #data.rooms do
					local room = properties[_property].rooms[i]
					if not room.owner then
						properties[_property].rooms[i].owner = source
						TriggerClientEvent('properties:updateData', -1, _property, i, properties[_property].rooms[i])
						TriggerClientEvent('properties:updateBlip', source, _property, i)
						TriggerClientEvent('usa:notify', source, 'Your property is at ~y~'.._property..'~s~, room '..i..'.')
						if spawnAtProperty then
							TriggerEvent('properties:requestEntry', _property, i, source)
						end
						return
					end
				end
			end
		end
	else
		_data = {
			name = 'House',
			coords = property['houseCoords'],
			garage = property['garageCoords'],
			heading = property['houseHeading'],
			owner = source,
			voiceChannel = property['house'],
			instance = {},
			locked = true
		}
		table.insert(properties['Houses'].rooms, _data)
		for i = 1, #properties['Houses'].rooms do
			local room = properties['Houses'].rooms[i]
			if room.owner == source then
				TriggerClientEvent('properties:updateData', -1, 'Houses', i, properties['Houses'].rooms[i])
				TriggerClientEvent('properties:updateBlip', source, 'Houses', i)
				if spawnAtProperty then
					TriggerEvent('properties:requestEntry', 'Houses', i, source)
				end
				return
			end
		end
	end
end

function GetWholeDaysFromTime(reference_time)
	local timestamp = os.date("*t", os.time())
	local daysfrom = os.difftime(os.time(), reference_time) / (24 * 60 * 60) -- seconds in a day
	local wholedays = math.floor(daysfrom)
	print("property owned whole days: " .. wholedays) -- today it prints "1"
	return wholedays
end

AddEventHandler('playerDropped', function()
	-- remove a character's room if they already had one -- 
	for property, data in pairs(properties) do
		for i = 1, #data.rooms do
			local room = properties[property].rooms[i]
			for j = 1, #room.instance do
				if source == room.instance[j] then
					table.remove(properties[property].rooms[i].instance, j)
					print('removing source '.. j .. ' from room '..i..' instance')
				end
			end
			if room.owner == source then
				print('removing room '.. i .. ' from '..source)
				properties[property].rooms[i].owner = false
				TriggerClientEvent('properties:updateData', -1, property, i, properties[property].rooms[i])
			end
		end
	end

	for i = 1, #properties['Houses'].rooms do
		local room = properties['Houses'].rooms[i]
		for j = 1, #room.instance do
			if source == room.instance[j] then
				table.remove(properties['Houses'].rooms[i].instance, j)
				print('removing source '.. j .. ' from room '..i..' instance')
			end
		end
		if room.owner == source then
			print('removing house from '..source)
			table.remove(properties['Houses'].rooms, i)
			TriggerClientEvent('properties:removeData', -1, 'Houses', i)
		end
	end
end)

RegisterServerEvent('properties:getAddress')
AddEventHandler('properties:getAddress', function(ssn, callback)
	for property, data in pairs(properties) do
		if property.type ~= 'house' then
			for i = 1, #data.rooms do
				local room = properties[property].rooms[i]
				if room.owner == ssn then
					callback(property .. ', ' .. room.name .. ' ('..data.location..')')
					return
				end
			end
		end
	end
	callback('Address not found!')
end)

RegisterServerEvent('character:loadCharacter')
AddEventHandler('character:loadCharacter', function(activeSlot, spawnAtProperty)
	RefreshProperties(source, spawnAtProperty)
end)

RegisterServerEvent('properties:moveProperties')
AddEventHandler('properties:moveProperties', function(location)
	local user = exports["essentialmode"]:getPlayerFromId(source)
	local userMoney = user.getActiveCharacterData('money')
	local property = user.getActiveCharacterData('property')
	if properties[property['location']].type == 'motel' then
		if location ~= property['location'] then
			for i = 1, #properties[location].rooms do
				local room = properties[location].rooms[i]
				if not room.owner then
					if userMoney - 500 >= 0 then
						print('room '..i..' was free, giving to '..source)
						for _property, data in pairs(properties) do
							for i = 1, #data.rooms do
								local room = properties[_property].rooms[i]
								if room.owner == source then
									print('removing room '.. i .. ' from '..source..', moving properties')
									properties[_property].rooms[i].owner = false
								end
							end
						end
						property['location'] = location
						user.setActiveCharacterData('property', property)
						user.setActiveCharacterData('money', userMoney - 500)
						properties[location].rooms[i].owner = source
						TriggerClientEvent('properties:updateData', -1, location, i, properties[location].rooms[i])
						TriggerClientEvent('usa:notify', source, 'Your room no. is '..i..', here are the keys.')
						TriggerClientEvent('properties:updateBlip', source, location, i)
						return
					else
						TriggerClientEvent('usa:notify', source, 'You cannot afford this purchase!')
						return
					end
				end
			end
		else
			TriggerClientEvent('usa:notify', source, 'You already own a room here!')
			return
		end
		TriggerClientEvent('usa:notify', source, 'All rooms at this property are taken!')
		return
	end
end)

RegisterServerEvent('properties:requestEntry')
AddEventHandler('properties:requestEntry', function(location, index, _source)
	if _source then
		source = tonumber(_source)
	end
	print('entry requested for source '..source.. ' at location '..location.. ' with room '..index)
	local room = properties[location].rooms[index]
	if not room.locked or room.owner == source then
		table.insert(properties[location].rooms[index].instance, source)
		TriggerClientEvent('properties:updateData', -1, location, index, properties[location].rooms[index])
		local currentProperty = {
			location = location,
			index = index,
			owner = room.owner,
			name = room.name,
			entryHeading = interiors[properties[location].interior].heading,
			entryCoords = interiors[properties[location].interior].coords,
			instance = room.instance,
			exitCoords = room.coords,
			exitHeading = room.heading,
			storageCoords = interiors[properties[location].interior].storage,
			wardrobeCoords = interiors[properties[location].interior].wardrobe,
			bathroomCoords = interiors[properties[location].interior].bathroom,
			voiceChannel = room.voiceChannel
		}
		TriggerClientEvent('properties:enterProperty', source, currentProperty)
		Citizen.Wait(1000)
		for i = 1, #room.instance do
			local sourceInside = properties[location].rooms[index].instance[i]
			TriggerClientEvent('properties:updateInstance', sourceInside, properties[location].rooms[index].instance)
		end
	end
end)

RegisterServerEvent('properties:forceEntry')
AddEventHandler('properties:forceEntry', function(location, index)
	print('entry forced for source '..source.. ' at location '..location.. ' with room '..index)
	local room = properties[location].rooms[index]
	table.insert(properties[location].rooms[index].instance, source)
	TriggerClientEvent('properties:updateData', -1, location, index, properties[location].rooms[index])
	local currentProperty = {
		location = location,
		index = index,
		owner = room.owner,
		name = room.name,
		entryHeading = interiors[properties[location].interior].heading,
		entryCoords = interiors[properties[location].interior].coords,
		instance = room.instance,
		exitCoords = room.coords,
		exitHeading = room.heading,
		storageCoords = interiors[properties[location].interior].storage,
		wardrobeCoords = interiors[properties[location].interior].wardrobe,
		bathroomCoords = interiors[properties[location].interior].bathroom,
		voiceChannel = room.voiceChannel
	}
	TriggerClientEvent('properties:breachProperty', source, currentProperty)
	Citizen.Wait(1000)
	for i = 1, #room.instance do
		local sourceInside = properties[location].rooms[index].instance[i]
		TriggerClientEvent('properties:updateInstance', sourceInside, properties[location].rooms[index].instance)
	end
end)


RegisterServerEvent('properties:requestExit')
AddEventHandler('properties:requestExit', function(location, index)
	local room = properties[location].rooms[index]
	for i = 1, #room.instance do
		if source == room.instance[i] then
			table.remove(properties[location].rooms[index].instance, i)
		end
	end
	TriggerClientEvent('properties:updateData', -1, location, index, properties[location].rooms[index])
	TriggerClientEvent('properties:exitProperty', source)
	Citizen.Wait(1000)
	for i = 1, #room.instance do
		local sourceInside = properties[location].rooms[index].instance[i]
		TriggerClientEvent('properties:updateInstance', sourceInside, properties[location].rooms[index].instance)
	end
end)

RegisterServerEvent('properties:toggleLock')
AddEventHandler('properties:toggleLock', function(location, index)
	local room = properties[location].rooms[index]
	if room.owner == source then
		room.locked = not room.locked
		if room.locked then
			TriggerClientEvent('usa:notify', source, room.name..' has been locked.')
		else
			TriggerClientEvent('usa:notify', source, room.name..' has been unlocked.')
		end
		TriggerClientEvent('properties:updateData', -1, location, index, properties[location].rooms[index])
	end
end)

RegisterServerEvent('properties:requestStorage')
AddEventHandler('properties:requestStorage', function(location, index)
	local room = properties[location].rooms[index]
	local targetSource = room.owner
	local target = exports["essentialmode"]:getPlayerFromId(targetSource)
	local user = exports["essentialmode"]:getPlayerFromId(source)
	local property = target.getActiveCharacterData("property")
	local menu_data = {
		property_items = property['storage'],
		user_items = {},
		money = property['money']
	}
	local inventory = user.getActiveCharacterData("inventory")
	local weapons = user.getActiveCharacterData("weapons")
	for i = 1, #inventory do table.insert(menu_data.user_items, inventory[i]) end
	for i = 1, #weapons do table.insert(menu_data.user_items, weapons[i]) end
	TriggerClientEvent("properties:openStorage", source, menu_data)
end)

RegisterServerEvent("properties:storeItem")
AddEventHandler("properties:storeItem", function(location, index, item, quantity)
	local room = properties[location].rooms[index]
    local userSource = source
    local user = exports["essentialmode"]:getPlayerFromId(userSource)
    local target = exports["essentialmode"]:getPlayerFromId(room.owner)
    local property = target.getActiveCharacterData('property')
    TriggerEvent("usa:removeItem", item, quantity, userSource)
    local itemCopy = item
    local hasItem = false
    itemCopy.quantity = quantity
    if canPropertyHoldItem(room.owner, location, itemCopy) then
	    for i = 1, #property['storage'] do
	    	local _item = property['storage'][i]
	        if _item.name == item.name then
	            if _item.type ~= "weapon" then
	                hasItem	= true
	                _item.quantity = _item.quantity + quantity
	                target.setActiveCharacterData('property', property)
	                TriggerClientEvent('usa:notify', userSource, '~y~'..item.name..' ~s~has been stored!')
	            end
	            break
	        end
	    end
	    if not hasItem then
	        table.insert(property['storage'], itemCopy)
	        target.setActiveCharacterData('property', property)
	        TriggerClientEvent('usa:notify', userSource, '~y~'..item.name..' ~s~has been stored!')
	    end
	else
		TriggerClientEvent('usa:notify', userSource, 'Property storage is full!')
	end
end)

RegisterServerEvent("properties:retrieveItem")
AddEventHandler("properties:retrieveItem", function(location, index, item, quantity)
	local room = properties[location].rooms[index]
	local userSource = source
    local user = exports["essentialmode"]:getPlayerFromId(userSource)
    local userInv = user.getActiveCharacterData('inventory')
    local target = exports["essentialmode"]:getPlayerFromId(room.owner)
    local property = target.getActiveCharacterData('property')
	item.quantity = quantity
	if user.getCanActiveCharacterHoldItem(item) then
		local storage = property['storage']
		for i = 1, #storage do
			if (storage[i].name == item.name and item.type ~= "weapon") or (item.type == "weapon" and storage[i].type == "weapon" and item.uuid == storage[i].uuid and storage[i].name == item.name) then
				if storage[i].quantity - quantity < 0 then
					TriggerClientEvent("usa:notify", userSource, "Invalid amount to retrieve!")
					return
				else
					if storage[i].quantity - quantity == 0 then
						table.remove(property['storage'], i)
						target.setActiveCharacterData('property', property)
						TriggerClientEvent('usa:notify', userSource, '~y~'..item.name..' ~s~has been retrieved!')
					else
						property['storage'][i].quantity = property['storage'][i].quantity - quantity
						target.setActiveCharacterData('property', property)
						TriggerClientEvent('usa:notify', userSource, '~y~'..item.name..' ~s~has been retrieved!')
					end
					break
				end
			else
      			if (item.type == "weapon" and storage[i].type == "weapon") and (not item.uuid and not storage[i].uuid) and (item.name == storage[i].name) then
           			table.remove(property['storage'], i)
           			target.setActiveCharacterData('property', property)
           			TriggerClientEvent('usa:notify', userSource, '~y~'..item.name..' ~s~has been retrieved!')
           			break
           		end
          	end
        end
		TriggerEvent("usa:insertItem", item, quantity, userSource)
	else
		TriggerClientEvent("usa:notify", userSource, "Inventory full.")
	end
end)

RegisterServerEvent("properties:withdrawMoney")
AddEventHandler("properties:withdrawMoney", function(location, index, amount)
	local room = properties[location].rooms[index]
	if room.owner then
		local user = exports["essentialmode"]:getPlayerFromId(source)
		local target = exports["essentialmode"]:getPlayerFromId(room.owner)
		local user_money = user.getActiveCharacterData("money")
		local property = target.getActiveCharacterData("property")
		if property["money"] - amount >= 0 then
			user.setActiveCharacterData("money", user_money + amount)
			property["money"] = property["money"] - amount
			target.setActiveCharacterData("property", property)
			TriggerClientEvent("usa:notify", source, "Withdrawn: ~y~$" .. amount)
		else
			TriggerClientEvent("usa:notify", source, "Not enough money in property!")
		end
	else
		TriggerClientEvent('usa:notify', source, "Owner not found, try again later!")
	end
end)

RegisterServerEvent("properties:storeMoney")
AddEventHandler("properties:storeMoney", function(location, index, amount)
	local room = properties[location].rooms[index]
	if room.owner then
		local user = exports["essentialmode"]:getPlayerFromId(source)
		local target = exports["essentialmode"]:getPlayerFromId(room.owner)
		local user_money = user.getActiveCharacterData("money")
		local property = target.getActiveCharacterData("property")
		if user_money - amount >= 0 then
			if (property["money"] + amount) > properties[location].cashLimit then
				TriggerClientEvent("usa:notify", source, "You may only store up to ~y~$"..properties[location].cashLimit..'!')
			else
				user.setActiveCharacterData("money", user_money - amount)
				property["money"] = property["money"] + amount
				target.setActiveCharacterData("property", property)
				TriggerClientEvent("usa:notify", source, "Stored: ~y~$" .. amount)
			end
		else
			TriggerClientEvent("usa:notify", source, "You don't have enough money!")
		end
	else
		TriggerClientEvent('usa:notify', source, "Owner not found, try again later!")
	end
end)

RegisterServerEvent('properties:cleanTools')
AddEventHandler('properties:cleanTools', function()
	local user = exports['essentialmode']:getPlayerFromId(source)
	local inventory = user.getActiveCharacterData('inventory')
	local itemsFound = false
	for i = 1, #inventory do
		local item = inventory[i]
		if item.resiude then
			itemsFound = true
			item.residue = false
		end
	end
	if not itemsFound then
		TriggerClientEvent('usa:notify', source, 'You have no tools that need cleaning!')
	else
		user.setActiveCharacterData('inventory', inventory)
		local anim = {
			dict = "anim@move_m@trash",
			name = "pickup"
		}
		TriggerClientEvent("usa:playAnimation", source, anim.dict, anim.name, -8, 1, -1, 53, 0, 0, 0, 0, 1.5)
		TriggerClientEvent('usa:notify', source, 'Your tools have been cleaned.')
	end
end)

RegisterServerEvent('properties:requestRealEstateMenu')
AddEventHandler('properties:requestRealEstateMenu', function()
	local user = exports['essentialmode']:getPlayerFromId(source)
	local property = user.getActiveCharacterData('property')
	TriggerClientEvent('properties:openRealEstateMenu', source, property)
end)

RegisterServerEvent('properties:estateChange')
AddEventHandler('properties:estateChange', function(estate)
	local user = exports['essentialmode']:getPlayerFromId(source)
	local property = user.getActiveCharacterData('property')
	if not property['house'] then
		local interior = properties[property['location']].interior
		local userMoney = user.getActiveCharacterData('money')
		local today = os.date("*t", os.time())
		if estate == 'motel' then
			property['location'] = 'Perrera Beach Motel'
			property['paid_time'] = os.time()

			user.setActiveCharacterData('property', property)
		elseif estate == 'lowapartment' then
			if userMoney - 1500 >= 0 then
				property['location'] = 'Burton Apartments'
				property['paid_time'] = os.time()
				user.setActiveCharacterData('property', property)
				user.setActiveCharacterData('money', userMoney - 1500)
			else
				TriggerClientEvent('usa:notify', source, 'You cannot afford this purchase.')
			end
		elseif estate == 'midapartment' then
			if userMoney - 3000 >= 0 then
				property['location'] = 'Tinsel Towers'
				property['paid_time'] = os.time()
				user.setActiveCharacterData('property', property)
				user.setActiveCharacterData('money', userMoney - 3000)
			else
				TriggerClientEvent('usa:notify', source, 'You cannot afford this purchase.')
			end
		elseif estate == 'highapartment' then
			if userMoney - 7500 >= 0 then
				property['location'] = 'Eclipse Towers'
				property['paid_time'] = os.time()
				user.setActiveCharacterData('property', property)
				user.setActiveCharacterData('money', userMoney - 7500)
			else
				TriggerClientEvent('usa:notify', source, 'You cannot afford this purchase.')
			end
		end
		TriggerClientEvent('usa:notify', source, 'You have relocated to ~y~'..property['location']..'~s~.')
		TriggerClientEvent('usa:showHelp', source, 'Weekly payments are covered from your bank balance, ensure you have enough each week.')
		RefreshProperties(source, false)
	end
end)

RegisterServerEvent('properties:requestAllData')
AddEventHandler('properties:requestAllData', function()
	TriggerClientEvent('properties:returnAllData', source, properties)
end)

RegisterServerEvent('properties:buzzApartment')
AddEventHandler('properties:buzzApartment', function(location, index)
	local room = properties[location].rooms[index]
	if room.owner == source then
		TriggerEvent('properties:requestEntry', location, index, source)
	else
		for i = 1, #room.instance do
			TriggerClientEvent('properties:buzzMe', room.instance[i])
		end
	end
end)

TriggerEvent('es:addCommand','buzzaccept', function(source, args, user)
	for property, data in pairs(properties) do
		for i = 1, #data.rooms do
			local room = properties[property].rooms[i]
			for j = 1, #room.instance do
				if room.instance[j] == source then
					TriggerClientEvent('properties:buzzEnter', -1, property, i)
					properties[property].rooms[i].locked = false
					print('unlocked for buzz')
					SetTimeout(30000, function()
						properties[property].rooms[i].locked = true
					end)
					break
				end
			end
		end
	end
end, {
	help = "Accept a buzz request when in an apartment."
})